!function(){var n={},t=function(t){for(var e=n[t],o=e.deps,r=e.defn,f=o.length,d=new Array(f),u=0;u<f;++u)d[u]=i(o[u]);var a=r.apply(null,d);if(void 0===a)throw"module ["+t+"] returned undefined";e.instance=a},e=function(t,e,i){if("string"!=typeof t)throw"module id must be a string";if(void 0===e)throw"no dependencies for "+t;if(void 0===i)throw"no definition function for "+t;n[t]={deps:e,defn:i,instance:void 0}},i=function(e){var i=n[e];if(void 0===i)throw"module ["+e+"] was undefined";return void 0===i.instance&&t(e),i.instance},o=function(n,t){for(var e=n.length,o=new Array(e),r=0;r<e;++r)o[r]=i(n[r]);t.apply(null,o)};({}).bolt={module:{api:{define:e,require:o,demand:i}}};var r=e;(function(n,t){r(n,[],function(){return t})})("4",tinymce.util.Tools.resolve),r("1",["4"],function(n){return n("tinymce.Env")}),r("2",["4"],function(n){return n("tinymce.PluginManager")}),r("5",[],function(){return{getAutoLinkPattern:function(n){return n.getParam("autolink_pattern",/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i)},getDefaultLinkTarget:function(n){return n.getParam("default_link_target","")}}}),r("3",["1","2","5"],function(n,t,e){var i=function(n,t){return n===t||" "===n||160===n.charCodeAt(0)},o=function(n){c(n,-1,"(",!0)},r=function(n){c(n,0,"",!0)},f=function(n){c(n,-1,"",!1)},d=function(n,t){if(t<0&&(t=0),3===n.nodeType){var e=n.data.length;t>e&&(t=e)}return t},u=function(n,t,e){1!==t.nodeType||t.hasChildNodes()?n.setStart(t,d(t,e)):n.setStartBefore(t)},a=function(n,t,e){1!==t.nodeType||t.hasChildNodes()?n.setEnd(t,d(t,e)):n.setEndAfter(t)},c=function(n,t,o){var r,f,d,c,s,l,g,h,m,p,v=e.getAutoLinkPattern(n),y=e.getDefaultLinkTarget(n);if("A"!==n.selection.getNode().tagName){if((r=n.selection.getRng(!0).cloneRange()).startOffset<5){if(!(h=r.endContainer.previousSibling)){if(!r.endContainer.firstChild||!r.endContainer.firstChild.nextSibling)return;h=r.endContainer.firstChild.nextSibling}if(m=h.length,u(r,h,m),a(r,h,m),r.endOffset<5)return;f=r.endOffset,c=h}else{if(3!==(c=r.endContainer).nodeType&&c.firstChild){for(;3!==c.nodeType&&c.firstChild;)c=c.firstChild;3===c.nodeType&&(u(r,c,0),a(r,c,c.nodeValue.length))}f=1===r.endOffset?2:r.endOffset-1-t}d=f;do{u(r,c,f>=2?f-2:0),a(r,c,f>=1?f-1:0),f-=1,p=r.toString()}while(" "!==p&&""!==p&&160!==p.charCodeAt(0)&&f-2>=0&&p!==o);i(r.toString(),o)?(u(r,c,f),a(r,c,d),f+=1):0===r.startOffset?(u(r,c,0),a(r,c,d)):(u(r,c,f),a(r,c,d)),"."===(l=r.toString()).charAt(l.length-1)&&a(r,c,d-1),(g=(l=r.toString().trim()).match(v))&&("www."===g[1]?g[1]="http://www.":/@$/.test(g[1])&&!/^mailto:/.test(g[1])&&(g[1]="mailto:"+g[1]),s=n.selection.getBookmark(),n.selection.setRng(r),n.execCommand("createlink",!1,g[1]+g[2]),y&&n.dom.setAttrib(n.selection.getNode(),"target",y),n.selection.moveToBookmark(s),n.nodeChanged())}};return{setup:function(t){var e;return t.on("keydown",function(n){if(13===n.keyCode)return f(t)}),n.ie?void t.on("focus",function(){if(!e){e=!0;try{t.execCommand("AutoUrlDetect",!1,!0)}catch(n){}}}):(t.on("keypress",function(n){if(41===n.keyCode)return o(t)}),void t.on("keyup",function(n){if(32===n.keyCode)return r(t)}))}}}),r("0",["1","2","3"],function(n,t,e){return t.add("autolink",function(n){e.setup(n)}),function(){}}),i("0")()}();