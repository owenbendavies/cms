!function(){var t={},n=function(n){for(var e=t[n],a=e.deps,o=e.defn,i=a.length,f=new Array(i),d=0;d<i;++d)f[d]=r(a[d]);var u=o.apply(null,f);if(void 0===u)throw"module ["+n+"] returned undefined";e.instance=u},e=function(n,e,r){if("string"!=typeof n)throw"module id must be a string";if(void 0===e)throw"no dependencies for "+n;if(void 0===r)throw"no definition function for "+n;t[n]={deps:e,defn:r,instance:void 0}},r=function(e){var r=t[e];if(void 0===r)throw"module ["+e+"] was undefined";return void 0===r.instance&&n(e),r.instance},a=function(t,n){for(var e=t.length,a=new Array(e),o=0;o<e;++o)a[o]=r(t[o]);n.apply(null,a)};({}).bolt={module:{api:{define:e,require:a,demand:r}}};var o=e,i=function(t,n){o(t,[],function(){return n})};o("1",[],function(){var t=function(n){var e=n,r=function(){return e};return{get:r,set:function(t){e=t},clone:function(){return t(r())}}};return t}),i("6",tinymce.util.Tools.resolve),o("2",["6"],function(t){return t("tinymce.PluginManager")}),o("3",[],function(){return{get:function(t){return{setPatterns:function(n){t.set(n)},getPatterns:function(){return t.get()}}}}}),o("4",[],function(){var t=[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"***",end:"***",format:["bold","italic"]},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}];return{getPatterns:function(n){return void 0!==n.textpattern_patterns?n.textpattern_patterns:t}}}),o("7",["6"],function(t){return t("tinymce.util.Delay")}),o("8",["6"],function(t){return t("tinymce.util.VK")}),i("b",document),o("c",["6"],function(t){return t("tinymce.dom.TreeWalker")}),o("d",["6"],function(t){return t("tinymce.util.Tools")}),o("e",[],function(){var t=function(t){return t.sort(function(t,n){return t.start.length>n.start.length?-1:t.start.length<n.start.length?1:0})},n=function(t,n,e,r){return n.substr(e-t.end.length-r,t.end.length)===t.end},e=function(t,n,e){return t-n-e.end.length-e.start.length>0};return{findPattern:function(t,n){for(var e=0;e<t.length;e++)if(0===n.indexOf(t[e].start)&&(!t[e].end||n.lastIndexOf(t[e].end)===n.length-t[e].end.length))return t[e]},findEndPattern:function(r,a,o,i){var f,d,u=t(r);for(d=0;d<u.length;d++)if(f=u[d],void 0!==f.end&&n(f,a,o,i)&&e(o,i,f))return f}}}),o("a",["b","c","d","e"],function(t,n,e,r){var a=function(t,n,e,r){return(t=r>0?t.splitText(r):t).splitText(e-r+n.end.length),t.deleteData(0,n.start.length),t.deleteData(t.data.length-n.end.length,n.end.length),t},o=function(n,e,a){if(!1!==e.collapsed){var o=e.startContainer,i=o.data,f=!0===a?1:0;if(3===o.nodeType){var d=r.findEndPattern(n,i,e.startOffset,f);if(void 0!==d){var u=i.lastIndexOf(d.end,e.startOffset-f),c=i.lastIndexOf(d.start,u-d.end.length);if(u=i.indexOf(d.end,c+d.start.length),-1!==c){var s=t.createRange();s.setStart(o,c),s.setEnd(o,u+d.end.length);var l=r.findPattern(n,s.toString());if(!(void 0===d||l!==d||o.data.length<=d.start.length+d.end.length))return{pattern:d,startOffset:c,endOffset:u}}}}}},i=function(t,n,r,o){var i=e.isArray(r.pattern.format)?r.pattern.format:[r.pattern.format];if(0!==e.grep(i,function(n){var e=t.formatter.get(n);return e&&e[0].inline}).length)return t.undoManager.transact(function(){n=a(n,r.pattern,r.endOffset,r.startOffset,o),i.forEach(function(e){t.formatter.apply(e,{},n)})}),n},f=function(t,n,e){var r=t.selection.getRng(!0),a=o(n,r,e);if(a)return i(t,r.startContainer,a,e)};return{patternFromRng:o,applyInlineFormatSpace:function(t,n){return f(t,n,!0)},applyInlineFormatEnter:function(t,n){return f(t,n,!1)},applyBlockFormat:function(t,a){var o,i,f,d,u,c,s,l,g,h,m;if(o=t.selection,i=t.dom,o.isCollapsed()&&(s=i.getParent(o.getStart(),"p"))){for(g=new n(s,s);u=g.next();)if(3===u.nodeType){d=u;break}if(d){if(!(l=r.findPattern(a,d.data)))return;if(f=(h=o.getRng(!0)).startContainer,m=h.startOffset,d===f&&(m=Math.max(0,m-l.start.length)),e.trim(d.data).length===l.start.length)return;l.format&&((c=t.formatter.get(l.format))&&c[0].block&&(d.deleteData(0,l.start.length),t.formatter.apply(l.format,{},d),h.setStart(f,m),h.collapse(!0),o.setRng(h))),l.cmd&&t.undoManager.transact(function(){d.deleteData(0,l.start.length),t.execCommand(l.cmd)})}}}}}),o("9",["8","a"],function(t,n){function e(t,e){var r,a;(r=n.applyInlineFormatEnter(t,e))&&((a=t.dom.createRng()).setStart(r,r.data.length),a.setEnd(r,r.data.length),t.selection.setRng(a)),n.applyBlockFormat(t,e)}function r(t,e){var r,a,o,i,f;(r=n.applyInlineFormatSpace(t,e))&&(f=t.dom,a=r.data.slice(-1),/[\u00a0 ]/.test(a)&&(r.deleteData(r.data.length-1,1),o=f.doc.createTextNode(a),f.insertAfter(o,r.parentNode),(i=f.createRng()).setStart(o,1),i.setEnd(o,1),t.selection.setRng(i)))}var a=function(t,n,e){for(var r=0;r<t.length;r++)if(e(t[r],n))return!0};return{handleEnter:e,handleInlineKey:r,checkCharCode:function(t,n){return a(t,n,function(t,n){return t.charCodeAt(0)===n.charCode})},checkKeyCode:function(n,e){return a(n,e,function(n,e){return n===e.keyCode&&!1===t.modifierPressed(e)})}}}),o("5",["7","8","9"],function(t,n,e){return{setup:function(r,a){var o=[",",".",";",":","!","?"],i=[32];r.on("keydown",function(t){13!==t.keyCode||n.modifierPressed(t)||e.handleEnter(r,a.get())},!0),r.on("keyup",function(t){e.checkKeyCode(i,t)&&e.handleInlineKey(r,a.get())}),r.on("keypress",function(n){e.checkCharCode(o,n)&&t.setEditorTimeout(r,function(){e.handleInlineKey(r,a.get())})})}}}),o("0",["1","2","3","4","5"],function(t,n,e,r,a){return n.add("textpattern",function(n){var o=t(r.getPatterns(n.settings));return a.setup(n,o),e.get(o)}),function(){}}),r("0")()}();